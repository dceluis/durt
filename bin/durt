#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative '../lib/durt'

# Read lines from both file or STDIN
# lines = (ARGV[0] ? IO.readlines(ARGV[0]) : ARGF.readlines).map(&:chomp)

# puts Durt::VERSION

command = ARGV[0]
# options = ARGV[1..-1]

def current_project
  Durt::Project.current_project
end

NULL_COMMAND = Durt::Command::NullCommand
VERSION_COMMAND = Durt::Command::Version
BROWSE_DB_COMMAND = Durt::Command::BrowseDb
CONSOLE_COMMAND = Durt::Command::Console

COMMAND_TRANSLATIONS =
  {
    '-v' => VERSION_COMMAND,
    'db' => BROWSE_DB_COMMAND,
    'c' => CONSOLE_COMMAND,
    nil => NULL_COMMAND
  }.freeze

translated = COMMAND_TRANSLATIONS[command]

const_name = "Durt::Command::#{command.underscore.camelize}"

built =
  Object.const_defined?(const_name) && const_name.constantize

(translated || built || NULL_COMMAND).call
